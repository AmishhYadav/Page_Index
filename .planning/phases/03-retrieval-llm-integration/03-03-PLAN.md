# Plan 03-03: Expose /ask API and End-to-End Test

## Goal
Expose the retrieval and generation flow via a REST endpoint and verify with E2E tests.

<tasks>
  <task id="1" title="Implement /ask Endpoint">
    <description>Create `app/api/v1/ask.py` and register it in `app/main.py`. The endpoint should orchestrate `RetrievalService` and `LLMService` to return a final answer with citations.</description>
  </task>
  <task id="2" title="Observability Instrumentation">
    <description>Ensure `log_request_middleware` captures the latency of the `/ask` endpoint, including specific logs for retrieval vs. generation time.</description>
  </task>
  <task id="3" title="E2E Integration Test">
    <description>Create `test_03_03.py`. Ingest a document, then query the `/ask` API and assert that the response contains both an answer and a list of valid citations.</description>
  </task>
</tasks>

<verification>
1. `POST /api/v1/ask` returns status 200 and a JSON body with `answer` and `citations`.
2. Integration test confirms that data ingested in Phase 2 is retrievable in Phase 3.
</verification>

<must_haves>
- Documented API response schema.
- Latency logging for total request time.
</must_haves>
